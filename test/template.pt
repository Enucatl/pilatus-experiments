<html>
    <style>
        canvas, svg {
            position: absolute;
        }

        .axis text {
            font: 10px sans-serif;
        }

        .axis path,
        .axis line {
            fill: none;
            stroke: #000;
            shape-rendering: crispEdges;
        }

        .axis path {
            display: none;
        }
    </style>

    <body>
        <h1>Test image</h1>
        <div id="test-image" style="height: 600px;">
        </div>
        <div id="test-image-hor" style="height: 600px;">
        </div>
    </body>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8">
    </script>
    <script
        src="/static/_image.js"
        type="text/javascript">
    </script>
    <script
        src="/static/colorbar.js"
        type="text/javascript">
    </script>
    <script type="text/javascript">

        d3.json("/lena", function(error, json) {
            if (error) return console.warn(error);

            var image = d3.chart.image()
            .pixel_height(1)
            .pixel_width(1)
            .color_value(function(d) { return d; });

            d3.select("#test-image")
            .data([json])
            .call(image);

            var origin = {
                x: (image.width() + 
                    image.margin().left +
                    image.margin().right),
                y: image.margin().top
            }

            var colorbar = Colorbar()
                .scale(image.color())
                .origin(origin)
                .margin(image.margin())
                .barlength(512)
                .thickness(10);

            d3.select("#test-image")
            .call(colorbar);

            d3.select("#test-image-hor")
                .data([json])
                .call(image);

            var origin = {
                x: image.margin().left,
                y: (image.height() +
                    image.margin().top)
            }

            var colorbar_hor = Colorbar()
                .scale(image.color())
                .origin(origin)
                .margin(image.margin())
                .orient("horizontal")
                .image_thickness(image.height())
                .image_length(image.width())
                .barlength(512)
                .thickness(10);

            d3.select("#test-image-hor")
            .call(colorbar_hor);

        });

    </script>
</html>
